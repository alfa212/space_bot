# Телеграм-бот "Фото космоса"

Телеграм-бот, публикующий с заданным временным промежутком фотографии космической тематики в ваш телеграм-канал.

## Настройка

Для использования бота необходимо создать файл .env в корневой папке приложения и задать там три обязательных значения и одно необязательное:

### Обязательные поля (без них бот работать не будет):

Токен для скачивания фото с сайта Nasa. Можно получить по адресу https://api.nasa.gov

```
NASA_API_KEY='ваш_токен'
```

Токен вашего телеграм-бота. Для регистрации бота и получения токена найдите в Телеграм @BotFather

```
TELEGRAM_BOT_TOKEN='ваш_токен'
```

Адрес вашего телеграм-канала, куда бот будет публиковать фото

```
TARGET_CHANNEL='@ваш_телеграм_канал'
```

### Необязательное поле:

Задержка между публикациями фото (в секундах). Если не указывать, будет использовано значение по умолчанию - раз в сутки.

```
PHOTO_POST_TIMEOUT=10
```

## Использование

При первом запуске бот создаст в своей дериктории три папки и скачает туда фотографии с последнего запуска SpaceX, фотографии Земли от Nasa и фотографии космоса от Nasa.

Сразу после создания папок бот опубликует одно из фото в указанный телеграм-канал. Будет скачано в общей сложности около 70 фотографий. После публикации фото удаляется для освобождения места на сервере.

Когда все фото будут опубликованы и, соответственно, в папках не останется ни одной фотографии для публикации, бот автоматически скачает новые фотографии с серверов Nasa и SpaceX и начнет публиковать их.

Если вы не хотите, чтобы после публикации фото удалялось, вы можете удалить строку 

``` python
os.remove(os.path.join(os.path.abspath(os.path.dirname(__file__)), f'{i}/{k}'))
```

в функции

``` python
def post_photo(token, pause, channel, *dirs):
    bot = telegram.Bot(token=token)

    for i in dirs:
        for k in listdir(i):
            bot.send_photo(chat_id=channel, photo=open(f'{i}/{k}', 'rb'))
            os.remove(os.path.join(os.path.abspath(os.path.dirname(__file__)), f'{i}/{k}'))
            time.sleep(pause)
```

но обратите внимание - если фото не будут удаляться, бот никогда не скачает новые фото - публикация зациклится. Т.е. бот будет публиковать скачанные при первом запуске фото по кругу.

